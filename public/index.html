<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mock Server Configuration</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="css/common.css" rel="stylesheet">
</head>

<body>
    <div class="container mt-4">
        <div class="main-header">
            <h1>üöÄ Mock Server Configuration</h1>
            <p>Create, manage, and test your API endpoints with ease</p>
        </div>

        <!-- Add New Endpoint Form -->
        <div class="add-endpoint-form card mb-3">
            <div class="card-header">
                <h4 class="mb-0">‚ú® Add New Endpoint</h4>
            </div>
            <div class="card-body">
                <!-- Compact Configuration Layout -->
                <div class="row g-3 mb-3">
                    <!-- Left Column: Basic Config -->
                    <div class="col-lg-4">
                        <div class="config-group">
                            <div class="row g-2">
                                <div class="col-12">
                                    <label class="form-label fw-semibold">Endpoint Name</label>
                                    <input type="text" class="form-control form-control-sm" id="newEndpointName"
                                        placeholder="e.g., users, products, auth">
                                </div>
                                <div class="col-6">
                                    <label class="form-label fw-semibold">Method</label>
                                    <select class="form-control form-control-sm" id="newMethod">
                                        <option value="GET">GET</option>
                                        <option value="POST">POST</option>
                                        <option value="PUT">PUT</option>
                                        <option value="PATCH">PATCH</option>
                                        <option value="DELETE">DELETE</option>
                                    </select>
                                </div>
                                <div class="col-6">
                                    <label class="form-label fw-semibold">Status</label>
                                    <input type="number" class="form-control form-control-sm" id="newStatusCode"
                                        value="200" min="100" max="599">
                                </div>
                                <div class="col-12">
                                    <label class="form-label fw-semibold">Delay (ms)</label>
                                    <input type="number" class="form-control form-control-sm" id="newDelay" value="0"
                                        min="0" max="10000">
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Middle Column: Response Body -->
                    <div class="col-lg-4">
                        <div class="config-group">
                            <label class="form-label fw-semibold">Response Body (JSON)</label>
                            <textarea class="form-control form-control-sm" id="newResponseBody" rows="5"
                                placeholder='{"message": "Hello World", "status": "success"}'></textarea>
                            <div class="mt-2 d-flex gap-1">
                                <input type="file" id="newResponseFile" accept=".json"
                                    class="form-control form-control-sm">
                                <button type="button" class="btn btn-outline-secondary btn-sm"
                                    id="newUploadBtn">üìÅ</button>
                            </div>
                        </div>
                    </div>

                    <!-- Right Column: Expected Fields & Add Button -->
                    <div class="col-lg-4">
                        <div class="config-group">
                            <div class="mb-3">
                                <label class="form-label fw-semibold">Expected Fields</label>
                                <textarea class="form-control form-control-sm" id="newExpectedFields" rows="3"
                                    placeholder='["name", "email", "phone"]' disabled></textarea>
                            </div>
                            <button class="btn btn-success btn-sm w-100" id="addEndpointBtn" style="height: 50px;">
                                Add Endpoint
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Status Message -->
                <div id="addStatus" class="mt-2" style="display: none;"></div>
            </div>
        </div>

        <!-- Existing Endpoints Section -->
        <div class="section-header mb-3">
            <div class="d-flex align-items-center justify-content-between">
                <div>
                    <h3 class="mb-1">Available Endpoints</h3>
                    <p class="text-muted mb-0">Manage and test your configured API endpoints</p>
                </div>
                <div class="endpoint-count-badge">
                    <span class="badge bg-primary" id="endpointCount">0 endpoints</span>
                </div>
            </div>
        </div>

        <div class="row" id="endpoints">
            <!-- Endpoint cards will be dynamically inserted here -->
        </div>
    </div>

    <template id="endpoint-template">
        <div class="col-12 mb-3">
            <div class="card endpoint-card">
                <button class="btn btn-danger btn-sm remove-btn" title="Remove Endpoint">√ó</button>
                <div class="card-body">
                    <!-- Compact Configuration Layout -->
                    <div class="row g-3 mb-3">
                        <!-- Left Column: Basic Config -->
                        <div class="col-lg-4">
                            <div class="config-group">
                                <div class="row g-2">
                                    <div class="col-12">
                                        <label class="form-label fw-semibold">Endpoint Name</label>
                                        <input type="text" class="form-control form-control-sm endpoint-name"
                                            value="{endpoint}" placeholder="e.g., users, products, auth">
                                    </div>
                                    <div class="col-6">
                                        <label class="form-label fw-semibold">Method</label>
                                        <select class="form-control form-control-sm endpoint-method">
                                            <option value="GET">GET</option>
                                            <option value="POST">POST</option>
                                            <option value="PUT">PUT</option>
                                            <option value="PATCH">PATCH</option>
                                            <option value="DELETE">DELETE</option>
                                        </select>
                                    </div>
                                    <div class="col-6">
                                        <label class="form-label fw-semibold">Status</label>
                                        <input type="number" class="form-control form-control-sm status-code"
                                            value="200" min="100" max="599">
                                    </div>
                                    <div class="col-12">
                                        <label class="form-label fw-semibold">Delay (ms)</label>
                                        <input type="number" class="form-control form-control-sm delay" value="0"
                                            min="0" max="10000">
                                    </div>
                                </div>
                                <div class="mt-2">
                                    <div class="endpoint-url-compact">
                                        <span class="endpoint-url">{baseUrl}/{endpoint}</span>
                                        <button class="btn btn-outline-secondary btn-sm copy-url-btn"
                                            title="Copy URL">üìã</button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Middle Column: Response & Validation -->
                        <div class="col-lg-4">
                            <div class="config-group">
                                <label class="form-label fw-semibold">Response Body (JSON)</label>
                                <textarea class="form-control form-control-sm response-body" rows="5"
                                    placeholder='{"message": "Hello World", "status": "success"}'></textarea>
                                <div class="mt-2 d-flex gap-1">
                                    <input type="file" class="form-control form-control-sm response-file"
                                        accept=".json">
                                    <button type="button"
                                        class="btn btn-outline-secondary btn-sm upload-btn">üìÅ</button>
                                </div>

                                <div class="expected-fields-section mt-3">
                                    <label class="form-label fw-semibold">Expected Fields</label>
                                    <textarea class="form-control form-control-sm expected-fields" rows="2"
                                        placeholder='["name", "email", "phone"]'></textarea>
                                </div>
                            </div>
                        </div>

                        <!-- Right Column: Testing -->
                        <div class="col-lg-4">
                            <div class="config-group">
                                <div class="test-request-body-section mb-3">
                                    <label class="form-label fw-semibold">Test Request Body</label>
                                    <textarea class="form-control form-control-sm test-request-body" rows="3"
                                        placeholder='{"name": "John", "email": "john@example.com"}'></textarea>
                                </div>

                                <div class="d-flex gap-2 mb-3">
                                    <button class="btn btn-secondary btn-sm test-btn flex-fill">Test</button>
                                    <button class="btn btn-primary btn-sm update-btn flex-fill">Update</button>
                                </div>

                                <div class="response-preview-compact">
                                    <small class="text-muted fw-semibold">Test Response:</small>
                                    <pre class="test-response"></pre>
                                </div>

                                <div class="update-status mt-2"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </template>

    <script src="https://cdn.socket.io/4.7.1/socket.io.min.js"></script>
    <script src="js/config.js"></script>
    <script type="module" src="js/index.js"></script>
</body>

</html>